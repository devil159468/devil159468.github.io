import{_ as n,o as a,c as l,d as p}from"./app.1aa9c4fb.js";var e="/assets/AI01.9d7c0338.png",o="/assets/AI02.2f35611f.png",r="/assets/AI03.d4781727.png",c="/assets/AI04.9eeffacf.png",t="/assets/AI05.33293968.png",i="/assets/AI06.d4a52cc3.png",y="/assets/AI07.dc45d5c3.png",D="/assets/AI08.d5f0bf03.png",F="/assets/AIGPU.938b0cda.png",A="/assets/AI09.71fe2299.png",C="/assets/AI10.d4606df1.png",b="/assets/AI11.b080ea8a.png",u="/assets/AI12.406e02ec.png",s="/assets/AI14.dfdce332.png";const I=JSON.parse('{"title":"\u4EBA\u5DE5\u667A\u80FD\uFF08ArtificialIntelligence\uFF09","description":"","frontmatter":{},"headers":[{"level":2,"title":"\u8D44\u6E90\u94FE\u63A5","slug":"\u8D44\u6E90\u94FE\u63A5"},{"level":2,"title":"\u73AF\u5883\u5B89\u88C5","slug":"\u73AF\u5883\u5B89\u88C5"},{"level":2,"title":"\uFF01\u9A8C\u8BC1GPU\u52A0\u901F","slug":"\uFF01\u9A8C\u8BC1gpu\u52A0\u901F"},{"level":2,"title":"\u7F16\u8F91\u5668\u5B89\u88C5","slug":"\u7F16\u8F91\u5668\u5B89\u88C5"},{"level":2,"title":"\u6FC0\u52B1\u51FD\u6570 (Activation)","slug":"\u6FC0\u52B1\u51FD\u6570-activation"},{"level":2,"title":"\u56DE\u5F52 Regression","slug":"\u56DE\u5F52-regression"},{"level":2,"title":"\u5206\u7C7B Classification","slug":"\u5206\u7C7B-classification"},{"level":2,"title":"\u5FEB\u901F\u642D\u5EFA\u795E\u7ECF\u7F51\u7EDC","slug":"\u5FEB\u901F\u642D\u5EFA\u795E\u7ECF\u7F51\u7EDC"},{"level":2,"title":"\u4FDD\u5B58\u53CA\u63D0\u53D6","slug":"\u4FDD\u5B58\u53CA\u63D0\u53D6"},{"level":2,"title":"\u5206\u6279\u8BAD\u7EC3","slug":"\u5206\u6279\u8BAD\u7EC3"}],"relativePath":"07Game/ArtificialIntelligence.md","lastUpdated":1684493492000}'),m={name:"07Game/ArtificialIntelligence.md"},d=p(`<h1 id="\u4EBA\u5DE5\u667A\u80FD\uFF08artificialintelligence\uFF09" tabindex="-1">\u4EBA\u5DE5\u667A\u80FD\uFF08ArtificialIntelligence\uFF09 <a class="header-anchor" href="#\u4EBA\u5DE5\u667A\u80FD\uFF08artificialintelligence\uFF09" aria-hidden="true">#</a></h1><blockquote><p>\u8FD0\u884C\u73AF\u5883\uFF1AMacBook Pro M1Max 32G 1T</p><p>\u672C\u6587\u4E3B\u8981\u4EE5PyTorch\u4E3A\u4E3B</p></blockquote><h2 id="\u8D44\u6E90\u94FE\u63A5" tabindex="-1">\u8D44\u6E90\u94FE\u63A5 <a class="header-anchor" href="#\u8D44\u6E90\u94FE\u63A5" aria-hidden="true">#</a></h2><ul><li><a href="https://pytorch.org/" target="_blank" rel="noopener noreferrer">Pytorch\u5B98\u7F51</a></li><li><a href="https://www.anaconda.com/" target="_blank" rel="noopener noreferrer">Anaconda\u4E0B\u8F7D\u5730\u5740</a></li><li><a href="https://www.youtube.com/watch?v=QJgjcnuQqNI&amp;list=PLgAyVnrNJ96CqYdjZ8v9YjQvCBcK5PZ-V" target="_blank" rel="noopener noreferrer">\u6CB9\u7BA1\u6559\u7A0B - \u571F\u5806 33\u96C6</a></li><li><a href="https://www.youtube.com/watch?v=lAaCeiqE6CE&amp;list=PLXO45tsB95cJxT0mL0P3-G0rBcLSvVkKH" target="_blank" rel="noopener noreferrer">\u6CB9\u7BA1\u6559\u7A0B - \u83AB\u70E6 35\u96C6</a></li></ul><h2 id="\u73AF\u5883\u5B89\u88C5" tabindex="-1">\u73AF\u5883\u5B89\u88C5 <a class="header-anchor" href="#\u73AF\u5883\u5B89\u88C5" aria-hidden="true">#</a></h2><p><em>Anaconda</em> <a href="https://www.anaconda.com/download" target="_blank" rel="noopener noreferrer">\u4E0B\u8F7D\u5730\u5740</a></p><p>\u521B\u5EFA\u73AF\u5883\u547D\u4EE4</p><div class="language- line-numbers-mode"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">conda create -n pytorch310 python=3.10</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="`+e+'" alt="\u521D\u59CB\u5316\u754C\u9762"><img src="'+o+`" alt="\u6FC0\u6D3B\u73AF\u5883\u547D\u4EE4"> \u6FC0\u6D3B\u73AF\u5883\u547D\u4EE4</p><div class="language- line-numbers-mode"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">conda activate pytorch310</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="`+r+`" alt="\u53BB\u6FC0\u6D3B\u73AF\u5883\u547D\u4EE4"> \u53BB\u6FC0\u6D3B\u73AF\u5883\u547D\u4EE4</p><div class="language- line-numbers-mode"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">conda deactivate</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><blockquote><p>\u62A5\u9519\u5904\u7406\uFF1A</p></blockquote><ul><li><p>1.\u79FB\u9664\u4EE3\u7406</p><div class="language- line-numbers-mode"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">conda config --remove-key proxy</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li><li><p>2.\u4F7F\u7528\u955C\u50CF</p><div class="language- line-numbers-mode"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">conda config --set remote_read_timeout_secs 600 conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/</span></span>
<span class="line"><span style="color:#A6ACCD;">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/</span></span>
<span class="line"><span style="color:#A6ACCD;">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/pytorch/</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li><li><p>3.\u4E34\u65F6\u7981\u7528\u4EE3\u7406</p><div class="language- line-numbers-mode"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">conda config --set proxy_servers.http &quot;&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">conda config --set proxy_servers.https &quot;&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li></ul><hr><p><em>Pytorch\u5B89\u88C5</em> <a href="https://pytorch.org/" target="_blank" rel="noopener noreferrer">\u5B98\u7F51\u5730\u5740</a></p><p><img src="`+c+'" alt="\u9009\u62E9\u5BF9\u5E94\u7684\u7248\u672C\uFF0C\u590D\u5236\u547D\u4EE4\u5373\u53EF"> \u9009\u62E9\u5BF9\u5E94\u7684\u7248\u672C\uFF0C\u590D\u5236\u547D\u4EE4\u5373\u53EF</p><p><img src="'+t+'" alt="\u7701\u7565\u5176\u4F59\u5B89\u88C5\u5305"> \u7701\u7565\u5176\u4F59\u5B89\u88C5\u5305</p><p><img src="'+i+'" alt="\u5B89\u88C5\u5B8C\u6210"> \u5B89\u88C5\u5B8C\u6210</p><hr><p>\u9A8C\u8BC1\u662F\u5426\u5B89\u88C5\u6210\u529F</p><p>pip <img src="'+y+'" alt="\u9A8C\u8BC1\u662F\u5426\u5B89\u88C5\u6210\u529F"></p><p>\u547D\u4EE4\u884C\u5BFC\u5165\u6D4B\u8BD5\uFF0C\u65E0\u62A5\u9519\u5219\u5B89\u88C5\u6210\u529F <img src="'+D+'" alt="\u547D\u4EE4\u884C\u5BFC\u5165\u6D4B\u8BD5\uFF0C\u65E0\u62A5\u9519\u5219\u5B89\u88C5\u6210\u529F"></p><h2 id="\uFF01\u9A8C\u8BC1gpu\u52A0\u901F" tabindex="-1">\uFF01\u9A8C\u8BC1GPU\u52A0\u901F <a class="header-anchor" href="#\uFF01\u9A8C\u8BC1gpu\u52A0\u901F" aria-hidden="true">#</a></h2><p><img src="'+F+`" alt="\u9A8C\u8BC1GPU\u52A0\u901F"></p><div class="language- line-numbers-mode"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">import torch</span></span>
<span class="line"><span style="color:#A6ACCD;">a = torch.rand(3,5)</span></span>
<span class="line"><span style="color:#A6ACCD;">print(a)</span></span>
<span class="line"><span style="color:#A6ACCD;">b = torch.device(&#39;mps&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">print(b)</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="\u7F16\u8F91\u5668\u5B89\u88C5" tabindex="-1">\u7F16\u8F91\u5668\u5B89\u88C5 <a class="header-anchor" href="#\u7F16\u8F91\u5668\u5B89\u88C5" aria-hidden="true">#</a></h2><p><em>Pycharm</em> <a href="https://www.jetbrains.com/pycharm/download/#section=windows" target="_blank" rel="noopener noreferrer">\u4E0B\u8F7D\u5730\u5740</a></p><p><em>Jupiter</em> \u5B89\u88C5\u53CA\u4F7F\u7528</p><blockquote><p>python &lt; 3.10 \u4EE5\u4E0B\u53EF\u4F7F\u7528 conda install nb_conda</p></blockquote><p>python &gt;= 3.10 \u53EF\u4F7F\u7528 conda install -c conda-forge nb_conda_kernels</p><p>\u5F00\u542FJupyter NoteBook\u547D\u4EE4\uFF1Ajupyter notebook</p><h2 id="\u6FC0\u52B1\u51FD\u6570-activation" tabindex="-1">\u6FC0\u52B1\u51FD\u6570 (Activation) <a class="header-anchor" href="#\u6FC0\u52B1\u51FD\u6570-activation" aria-hidden="true">#</a></h2><p>\u6FC0\u52B1\u51FD\u6570\u6839\u636E\u4E0D\u540C\u60C5\u51B5\u9700\u8981\u6709\u4E0D\u540C\u9009\u62E9</p><ul><li>\u5377\u79EF\u795E\u7ECF\u7F51\u7EDC\uFF1AReLU</li><li>\u5FAA\u73AF\u795E\u7ECF\u7F51\u7EDC\uFF1ARelu Or Tanh</li></ul><p>\u5728AnaConda\u4E2D\u4F7F\u7528matplotlib</p><div class="language- line-numbers-mode"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">conda install matplotlib</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="`+A+`" alt="\u6FC0\u52B1\u51FD\u6570"></p><div class="language-python line-numbers-mode"><span class="copy"></span><pre><code><span class="line"><span style="color:#676E95;font-style:italic;"># \u6FC0\u52B1\u51FD\u6570</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> torch</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> torch</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">nn</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">functional</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#A6ACCD;"> F</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> torch</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">autograd </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> Variable</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> matplotlib</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">pyplot</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#A6ACCD;"> plt</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># fake data</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># x data (tensor), shape=(100,1)</span></span>
<span class="line"><span style="color:#A6ACCD;">x </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> torch</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">linspace</span><span style="color:#89DDFF;">(-</span><span style="color:#F78C6C;">5</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#F78C6C;">5</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#F78C6C;">200</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">x </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Variable</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">x</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">x_np </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> x</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">data</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">numpy</span><span style="color:#89DDFF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">y_relu </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> F</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">relu</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">x</span><span style="color:#89DDFF;">).</span><span style="color:#F07178;">data</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">numpy</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">y_sigmoid </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> F</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">sigmoid</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">x</span><span style="color:#89DDFF;">).</span><span style="color:#F07178;">data</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">numpy</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">y_tanh </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> F</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">tanh</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">x</span><span style="color:#89DDFF;">).</span><span style="color:#F07178;"> data</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">numpy</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">y_softplus </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> F</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">softplus</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">x</span><span style="color:#89DDFF;">).</span><span style="color:#F07178;">data</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">numpy</span><span style="color:#89DDFF;">()</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">plt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">figure</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;">figsize</span><span style="color:#89DDFF;">=(</span><span style="color:#F78C6C;">8</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#F78C6C;">6</span><span style="color:#89DDFF;">)</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">plt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">subplot</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">221</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">plt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">plot</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">x_np</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> y_relu</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;">c</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">red</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;">label</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">relu</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">plt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">ylim</span><span style="color:#89DDFF;">((-</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#F78C6C;">5</span><span style="color:#89DDFF;">))</span></span>
<span class="line"><span style="color:#A6ACCD;">plt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">legend</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">loc</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">best</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">plt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">subplot</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">222</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">plt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">plot</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">x_np</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> y_sigmoid</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;">c</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">blue</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;">label</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">sigmoid</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">plt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">ylim</span><span style="color:#89DDFF;">((-</span><span style="color:#F78C6C;">0.2</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#F78C6C;">1.2</span><span style="color:#89DDFF;">))</span></span>
<span class="line"><span style="color:#A6ACCD;">plt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">legend</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">loc</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">best</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">plt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">subplot</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">223</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">plt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">plot</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">x_np</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> y_tanh</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;">c</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">red</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;">label</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">tanh</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">plt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">ylim</span><span style="color:#89DDFF;">((-</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">))</span></span>
<span class="line"><span style="color:#A6ACCD;">plt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">legend</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">loc</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">best</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">plt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">subplot</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">224</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">plt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">plot</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">x_np</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> y_softplus</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;">c</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">red</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;">label</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">softplus</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">plt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">ylim</span><span style="color:#89DDFF;">((-</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#F78C6C;">6</span><span style="color:#89DDFF;">))</span></span>
<span class="line"><span style="color:#A6ACCD;">plt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">legend</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">loc</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">best</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">plt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">show</span><span style="color:#89DDFF;">()</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><h2 id="\u56DE\u5F52-regression" tabindex="-1">\u56DE\u5F52 Regression <a class="header-anchor" href="#\u56DE\u5F52-regression" aria-hidden="true">#</a></h2><p><img src="`+C+`" alt="\u56DE\u5F52"></p><div class="language-python line-numbers-mode"><span class="copy"></span><pre><code><span class="line"><span style="color:#676E95;font-style:italic;"># \u56DE\u5F52 Regression </span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> torch</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> torch</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">nn</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">functional</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#A6ACCD;"> F</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> torch</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">autograd </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> Variable</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> matplotlib</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">pyplot</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#A6ACCD;"> plt</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">x </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> torch</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">unsqueeze</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">torch</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">linspace</span><span style="color:#89DDFF;">(-</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#F78C6C;">100</span><span style="color:#89DDFF;">),</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;">dim</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">y </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> x</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">pow</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">2</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0.2</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> torch</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">rand</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">x</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">size</span><span style="color:#89DDFF;">())</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">x</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> y </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Variable</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">x</span><span style="color:#89DDFF;">),</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Variable</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">y</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># \u6253\u5370</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># plt.scatter(x.data.numpy(), y.data.numpy())</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># plt.show()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Net</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">torch</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">nn</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">Module</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">def</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">__init__</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">self</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> n_feature</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> n_hidden</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> n_output</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">super</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">Net</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;">self</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">__init__</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">        self</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">hidden</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> torch</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">nn</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Linear</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">n_feature</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> n_hidden</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">        self</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">predict</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> torch</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">nn</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Linear</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">n_hidden</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> n_output</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">def</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">forward</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">self</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> x</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#A6ACCD;">        x </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> F</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">relu</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">self</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">hidden</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">x</span><span style="color:#89DDFF;">))</span></span>
<span class="line"><span style="color:#A6ACCD;">        x </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> self</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">predict</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">x</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#A6ACCD;"> x</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">net </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Net</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#F78C6C;">10</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#82AAFF;">print</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">net</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">plt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">ion</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">plt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">show</span><span style="color:#89DDFF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">optimizer </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> torch</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">optim</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">SGD</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">net</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">parameters</span><span style="color:#89DDFF;">(),</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;">lr</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">0.5</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">loss_func </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> torch</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">nn</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">MSELoss</span><span style="color:#89DDFF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#A6ACCD;"> t </span><span style="color:#89DDFF;font-style:italic;">in</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">range</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">100</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#A6ACCD;">    prediction </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">net</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">x</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    loss </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">loss_func</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">prediction</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> y</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    optimizer</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">zero_grad</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">    loss</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">backward</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">    optimizer</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">step</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> t </span><span style="color:#89DDFF;">%</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">5</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">==</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">        plt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">cla</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">        plt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">scatter</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">x</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">data</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">numpy</span><span style="color:#89DDFF;">(),</span><span style="color:#82AAFF;"> y</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">data</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">numpy</span><span style="color:#89DDFF;">())</span></span>
<span class="line"><span style="color:#A6ACCD;">        plt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">plot</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">x</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">data</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">numpy</span><span style="color:#89DDFF;">(),</span><span style="color:#82AAFF;"> prediction</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">data</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">numpy</span><span style="color:#89DDFF;">(),</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">r-</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;">lw</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">5</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">        plt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">text</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">0.5</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">loss=%.4f</span><span style="color:#89DDFF;">&#39;</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">%</span><span style="color:#82AAFF;"> loss</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">data</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">item</span><span style="color:#89DDFF;">(),</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;">fontdict</span><span style="color:#89DDFF;">={</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">size</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">:</span><span style="color:#82AAFF;"> </span><span style="color:#F78C6C;">20</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">color</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">:</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">red</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">})</span></span>
<span class="line"><span style="color:#A6ACCD;">        plt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">pause</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">0.1</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">plt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">ioff</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">plt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">show</span><span style="color:#89DDFF;">()</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br></div></div><h2 id="\u5206\u7C7B-classification" tabindex="-1">\u5206\u7C7B Classification <a class="header-anchor" href="#\u5206\u7C7B-classification" aria-hidden="true">#</a></h2><p><img src="`+b+`" alt="\u5206\u7C7B"></p><div class="language- line-numbers-mode"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;"># \u5206\u7C7B Classification</span></span>
<span class="line"><span style="color:#A6ACCD;">import torch</span></span>
<span class="line"><span style="color:#A6ACCD;">import torch.nn.functional as F</span></span>
<span class="line"><span style="color:#A6ACCD;">from torch.autograd import Variable</span></span>
<span class="line"><span style="color:#A6ACCD;">import matplotlib.pyplot as plt</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;"># \u4E0D\u540C\u7684\u4EE3\u7801</span></span>
<span class="line"><span style="color:#A6ACCD;">n_data = torch.ones(100, 2)</span></span>
<span class="line"><span style="color:#A6ACCD;">x0 = torch.normal(2 * n_data, 1)  # class0 x data (tensor), shape=(100, 2)</span></span>
<span class="line"><span style="color:#A6ACCD;">y0 = torch.zeros(100)  # class0 y data (tensor), shape=(100, 2)</span></span>
<span class="line"><span style="color:#A6ACCD;">x1 = torch.normal(-2 * n_data, 1)  # class1 x data (tensor), shape=(100, 2)</span></span>
<span class="line"><span style="color:#A6ACCD;">y1 = torch.ones(100)  # class2 y data (tensor), shape=(100, 2)</span></span>
<span class="line"><span style="color:#A6ACCD;">x = torch.cat((x0, x1), 0).type(torch.FloatTensor)  # FloatTensor = 32-bit floating</span></span>
<span class="line"><span style="color:#A6ACCD;">y = torch.cat((y0, y1), ).type(torch.LongTensor)  # LongTensor = 64-bit integer</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">x, y = Variable(x), Variable(y)</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">plt.scatter(x.data.numpy()[:, 0], x.data.numpy()[:, 1], c=y.data.numpy(), s=100, lw=0, cmap=&#39;RdYlGn&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">plt.show()</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;"># \u6253\u5370</span></span>
<span class="line"><span style="color:#A6ACCD;"># plt.scatter(x.data.numpy(), y.data.numpy())</span></span>
<span class="line"><span style="color:#A6ACCD;"># plt.show()</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">class Net(torch.nn.Module):</span></span>
<span class="line"><span style="color:#A6ACCD;">    def __init__(self, n_feature, n_hidden, n_output):</span></span>
<span class="line"><span style="color:#A6ACCD;">        super(Net, self).__init__()</span></span>
<span class="line"><span style="color:#A6ACCD;">        self.hidden = torch.nn.Linear(n_feature, n_hidden)</span></span>
<span class="line"><span style="color:#A6ACCD;">        self.predict = torch.nn.Linear(n_hidden, n_output)</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">    def forward(self, x):</span></span>
<span class="line"><span style="color:#A6ACCD;">        x = F.relu(self.hidden(x))</span></span>
<span class="line"><span style="color:#A6ACCD;">        x = self.predict(x)</span></span>
<span class="line"><span style="color:#A6ACCD;">        return x</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">net = Net(2, 10, 2)</span></span>
<span class="line"><span style="color:#A6ACCD;">print(net)</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">plt.ion()</span></span>
<span class="line"><span style="color:#A6ACCD;">plt.show()</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">optimizer = torch.optim.SGD(net.parameters(), lr=0.02)</span></span>
<span class="line"><span style="color:#A6ACCD;">loss_func = torch.nn.CrossEntropyLoss()</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">for t in range(100):</span></span>
<span class="line"><span style="color:#A6ACCD;">    out = net(x)</span></span>
<span class="line"><span style="color:#A6ACCD;">    loss = loss_func(out, y)</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">    optimizer.zero_grad()</span></span>
<span class="line"><span style="color:#A6ACCD;">    loss.backward()</span></span>
<span class="line"><span style="color:#A6ACCD;">    optimizer.step()</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">    if t % 2 == 0:</span></span>
<span class="line"><span style="color:#A6ACCD;">        # plot and show learning process</span></span>
<span class="line"><span style="color:#A6ACCD;">        plt.cla()</span></span>
<span class="line"><span style="color:#A6ACCD;">        prediction = torch.max(F.softmax(out, dim=1), 1)[1]  # \u9884\u6D4B\u5206\u7C7B\u7ED3\u679C</span></span>
<span class="line"><span style="color:#A6ACCD;">        pred_y = prediction.data.numpy()</span></span>
<span class="line"><span style="color:#A6ACCD;">        target_y = y.data.numpy()</span></span>
<span class="line"><span style="color:#A6ACCD;">        plt.scatter(x.data.numpy()[:, 0], x.data.numpy()[:, 1], c=pred_y, s=100, lw=0, cmap=&#39;RdYlGn&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">        accuracy = float((pred_y == target_y).astype(int).sum()) / float(target_y.size)</span></span>
<span class="line"><span style="color:#A6ACCD;">        plt.text(1.5, -4, &#39;Accuracy=%.2f&#39; % accuracy, fontdict={&#39;size&#39;: 20, &#39;color&#39;: &#39;red&#39;})</span></span>
<span class="line"><span style="color:#A6ACCD;">        plt.pause(0.1)</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">plt.ioff()</span></span>
<span class="line"><span style="color:#A6ACCD;">plt.show()</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br></div></div><h2 id="\u5FEB\u901F\u642D\u5EFA\u795E\u7ECF\u7F51\u7EDC" tabindex="-1">\u5FEB\u901F\u642D\u5EFA\u795E\u7ECF\u7F51\u7EDC <a class="header-anchor" href="#\u5FEB\u901F\u642D\u5EFA\u795E\u7ECF\u7F51\u7EDC" aria-hidden="true">#</a></h2><p><img src="`+u+`" alt="\u5FEB\u901F\u642D\u5EFA\u795E\u7ECF\u7F51\u7EDC"></p><div class="language- line-numbers-mode"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">net2 = torch.nn.Sequential(</span></span>
<span class="line"><span style="color:#A6ACCD;">    torch.nn.Linear(2,10),</span></span>
<span class="line"><span style="color:#A6ACCD;">    torch.nn.ReLU(),</span></span>
<span class="line"><span style="color:#A6ACCD;">    torch.nn.Linear(10,2),</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">print(net2)</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="\u4FDD\u5B58\u53CA\u63D0\u53D6" tabindex="-1">\u4FDD\u5B58\u53CA\u63D0\u53D6 <a class="header-anchor" href="#\u4FDD\u5B58\u53CA\u63D0\u53D6" aria-hidden="true">#</a></h2><p><img src="`+s+`" alt="\u5206\u7C7B"></p><div class="language- line-numbers-mode"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;"># \u4FDD\u5B58\u53CA\u63D0\u53D6\u795E\u7ECF\u7F51\u7EDC</span></span>
<span class="line"><span style="color:#A6ACCD;">import torch</span></span>
<span class="line"><span style="color:#A6ACCD;">import matplotlib.pyplot as plt</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;"># torch.manual_seed(1)    # reproducible</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;"># fake data</span></span>
<span class="line"><span style="color:#A6ACCD;">x = torch.unsqueeze(torch.linspace(-1, 1, 100), dim=1)  # x data (tensor), shape=(100, 1)</span></span>
<span class="line"><span style="color:#A6ACCD;">y = x.pow(2) + 0.2*torch.rand(x.size())  # noisy y data (tensor), shape=(100, 1)</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;"># The code below is deprecated in Pytorch 0.4. Now, autograd directly supports tensors</span></span>
<span class="line"><span style="color:#A6ACCD;"># x, y = Variable(x, requires_grad=False), Variable(y, requires_grad=False)</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">def save():</span></span>
<span class="line"><span style="color:#A6ACCD;">    # save net1</span></span>
<span class="line"><span style="color:#A6ACCD;">    net1 = torch.nn.Sequential(</span></span>
<span class="line"><span style="color:#A6ACCD;">        torch.nn.Linear(1, 10),</span></span>
<span class="line"><span style="color:#A6ACCD;">        torch.nn.ReLU(),</span></span>
<span class="line"><span style="color:#A6ACCD;">        torch.nn.Linear(10, 1)</span></span>
<span class="line"><span style="color:#A6ACCD;">    )</span></span>
<span class="line"><span style="color:#A6ACCD;">    optimizer = torch.optim.SGD(net1.parameters(), lr=0.5)</span></span>
<span class="line"><span style="color:#A6ACCD;">    loss_func = torch.nn.MSELoss()</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">    for t in range(100):</span></span>
<span class="line"><span style="color:#A6ACCD;">        prediction = net1(x)</span></span>
<span class="line"><span style="color:#A6ACCD;">        loss = loss_func(prediction, y)</span></span>
<span class="line"><span style="color:#A6ACCD;">        optimizer.zero_grad()</span></span>
<span class="line"><span style="color:#A6ACCD;">        loss.backward()</span></span>
<span class="line"><span style="color:#A6ACCD;">        optimizer.step()</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">    # plot result</span></span>
<span class="line"><span style="color:#A6ACCD;">    plt.figure(1, figsize=(10, 3))</span></span>
<span class="line"><span style="color:#A6ACCD;">    plt.subplot(131)</span></span>
<span class="line"><span style="color:#A6ACCD;">    plt.title(&#39;Net1&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">    plt.scatter(x.data.numpy(), y.data.numpy())</span></span>
<span class="line"><span style="color:#A6ACCD;">    plt.plot(x.data.numpy(), prediction.data.numpy(), &#39;r-&#39;, lw=5)</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">    # 2 ways to save the net</span></span>
<span class="line"><span style="color:#A6ACCD;">    torch.save(net1, &#39;04net.pkl&#39;)  # save entire net</span></span>
<span class="line"><span style="color:#A6ACCD;">    torch.save(net1.state_dict(), &#39;04net_params.pkl&#39;)   # save only the parameters</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">def restore_net():</span></span>
<span class="line"><span style="color:#A6ACCD;">    # restore entire net1 to net2</span></span>
<span class="line"><span style="color:#A6ACCD;">    net2 = torch.load(&#39;04net.pkl&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">    prediction = net2(x)</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">    # plot result</span></span>
<span class="line"><span style="color:#A6ACCD;">    plt.subplot(132)</span></span>
<span class="line"><span style="color:#A6ACCD;">    plt.title(&#39;Net2&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">    plt.scatter(x.data.numpy(), y.data.numpy())</span></span>
<span class="line"><span style="color:#A6ACCD;">    plt.plot(x.data.numpy(), prediction.data.numpy(), &#39;r-&#39;, lw=5)</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">def restore_params():</span></span>
<span class="line"><span style="color:#A6ACCD;">    # restore only the parameters in net1 to net3</span></span>
<span class="line"><span style="color:#A6ACCD;">    net3 = torch.nn.Sequential(</span></span>
<span class="line"><span style="color:#A6ACCD;">        torch.nn.Linear(1, 10),</span></span>
<span class="line"><span style="color:#A6ACCD;">        torch.nn.ReLU(),</span></span>
<span class="line"><span style="color:#A6ACCD;">        torch.nn.Linear(10, 1)</span></span>
<span class="line"><span style="color:#A6ACCD;">    )</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">    # copy net1&#39;s parameters into net3</span></span>
<span class="line"><span style="color:#A6ACCD;">    net3.load_state_dict(torch.load(&#39;04net_params.pkl&#39;))</span></span>
<span class="line"><span style="color:#A6ACCD;">    prediction = net3(x)</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">    # plot result</span></span>
<span class="line"><span style="color:#A6ACCD;">    plt.subplot(133)</span></span>
<span class="line"><span style="color:#A6ACCD;">    plt.title(&#39;Net3&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">    plt.scatter(x.data.numpy(), y.data.numpy())</span></span>
<span class="line"><span style="color:#A6ACCD;">    plt.plot(x.data.numpy(), prediction.data.numpy(), &#39;r-&#39;, lw=5)</span></span>
<span class="line"><span style="color:#A6ACCD;">    plt.show()</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;"># save net1</span></span>
<span class="line"><span style="color:#A6ACCD;">save()</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;"># restore entire net (may slow)</span></span>
<span class="line"><span style="color:#A6ACCD;">restore_net()</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;"># restore only the net parameters</span></span>
<span class="line"><span style="color:#A6ACCD;">restore_params()</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br></div></div><h2 id="\u5206\u6279\u8BAD\u7EC3" tabindex="-1">\u5206\u6279\u8BAD\u7EC3 <a class="header-anchor" href="#\u5206\u6279\u8BAD\u7EC3" aria-hidden="true">#</a></h2><div class="language- line-numbers-mode"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;"># \u5206\u6279\u8BAD\u7EC3</span></span>
<span class="line"><span style="color:#A6ACCD;">import torch</span></span>
<span class="line"><span style="color:#A6ACCD;">import torch.utils.data as Data</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">torch.manual_seed(1)    # reproducible</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">BATCH_SIZE = 5</span></span>
<span class="line"><span style="color:#A6ACCD;"># BATCH_SIZE = 8</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">x = torch.linspace(1, 10, 10)       # this is x data (torch tensor)</span></span>
<span class="line"><span style="color:#A6ACCD;">y = torch.linspace(10, 1, 10)       # this is y data (torch tensor)</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">torch_dataset = Data.TensorDataset(x, y)</span></span>
<span class="line"><span style="color:#A6ACCD;">loader = Data.DataLoader(</span></span>
<span class="line"><span style="color:#A6ACCD;">    dataset=torch_dataset,      # torch TensorDataset format</span></span>
<span class="line"><span style="color:#A6ACCD;">    batch_size=BATCH_SIZE,      # mini batch size</span></span>
<span class="line"><span style="color:#A6ACCD;">    shuffle=True,               # random shuffle for training</span></span>
<span class="line"><span style="color:#A6ACCD;">    num_workers=2,              # subprocesses for loading data</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">def show_batch():</span></span>
<span class="line"><span style="color:#A6ACCD;">    for epoch in range(3):   # train entire dataset 3 times</span></span>
<span class="line"><span style="color:#A6ACCD;">        for step, (batch_x, batch_y) in enumerate(loader):  # for each training step</span></span>
<span class="line"><span style="color:#A6ACCD;">            # train your data...</span></span>
<span class="line"><span style="color:#A6ACCD;">            print(&#39;Epoch: &#39;, epoch, &#39;| Step: &#39;, step, &#39;| batch x: &#39;,</span></span>
<span class="line"><span style="color:#A6ACCD;">                  batch_x.numpy(), &#39;| batch y: &#39;, batch_y.numpy())</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">if __name__ == &#39;__main__&#39;:</span></span>
<span class="line"><span style="color:#A6ACCD;">    show_batch()</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><p><img src="`+s+'" alt="\u5206\u7C7B"></p>',54),h=[d];function f(_,g,v,x,w,E){return a(),l("div",null,h)}var z=n(m,[["render",f]]);export{I as __pageData,z as default};
